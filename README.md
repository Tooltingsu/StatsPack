# 📊 StatsPack - 全能服务器统计数据包 (Minecraft 1.21+)

**StatsPack** 是一个轻量级、高性能的 Minecraft 原版数据包，旨在为生存服务器提供实时、精准的玩家数据统计排行榜。

它采用了 **原版直显模式 (Direct Display)**，在保证 0 延迟刷新的同时，完美实现了离线玩家数据保留、假人自动过滤以及全服数据总览。

![Version](https://img.shields.io/badge/Minecraft-1.21%2B-brightgreen)
![Type](https://img.shields.io/badge/Type-Datapack-blue)
![Carpet](https://img.shields.io/badge/CarpetMod-Supported-orange)

## ✨ 主要功能

*   **9 大统计榜单**：挖掘、放置、移动距离(米)、击杀、PVP、承伤、输出、死亡、全服总览。
*   **实时刷新**：采用 1-tick (0.05秒) 级刷新率，数据跳动丝滑流畅。
*   **离线保留**：基于原版计分板机制，玩家离线后名字和数据依然保留在榜单上（Top 15）。
*   **智能轮播**：每 10 秒自动切换榜单，支持管理员手动暂停/切换。
*   **全服总计**：采用增量累加算法，统计服务器历史所有玩家（含离线）的数据总和。
*   **假人过滤**：完美配合 Carpet Mod，自动屏蔽假人（Bot）数据，防止污染榜单。
*   **可视化菜单**：提供交互式聊天栏菜单，管理员操作无需记忆指令。

---

## 📥 安装指南

### 1. 安装数据包 (必须)
1.  下载本仓库的 Release `.zip` 文件。
2.  将其放入你的存档或服务器的 `world/datapacks/` 文件夹中。
3.  在游戏中输入 `/reload`。
4.  如果你看到 **"[统计系统] 加载完成"** 的绿色提示，即表示安装成功。

### 2. 安装假人过滤脚本 (Carpet Mod 用户必读)
> ⚠️ **注意**：如果你的服务器安装了 **Carpet Mod** 并使用假人挂机，请务必安装此脚本！否则假人会出现在排行榜上并虚增全服总计数据。

1.  在本项目中找到 `stats_bot_manager.sc` 文件（或复制下方代码新建）。
2.  将该文件放入服务器的 **脚本配置文件夹**：
    *   路径：`.minecraft/config/carpet/scripts/`
3.  进入游戏，加载脚本并设置自动运行：
    ```mcfunction
    /script load stats_bot_manager
    /carpet scriptsAutoload true
    ```
    *(这一步可以确保每次开服脚本都会自动加载)*



## 🔑 权限获取

为防止普通玩家误操作核心设置，所有管理指令需先获取 `st_admin` 标签权限。

以OP身份或在控制台输入以下指令：

```mcfunction

/tag <你的游戏名> add st_admin
```

## 🖥️ 控制面板使用（推荐）

获取权限后，输入下方指令即可打开可视化交互菜单，无需记忆复杂代码，点击聊天栏选项即可完成操作：

```mcfunction

/function stats:help
```

## ⌨️ 快捷指令表

若需快速操作，可直接使用 Trigger 指令：`/trigger st_op set [对应代码]`

|指令代码|功能标识|具体功能|详细说明|
|---|---|---|---|
|1|⏯ 暂停/继续|榜单状态控制|锁定当前显示榜单，停止自动轮播；再次执行恢复轮播|
|2|👁 显示/隐藏|侧边栏显示控制|切换右侧数据侧边栏的显示与隐藏状态|
|10|⛏️ 挖掘榜|方块挖掘统计|展示所有玩家破坏方块的总数排名|
|11|🧱 放置榜|方块放置统计|展示所有玩家放置方块的总数排名|
|12|🏃 移动榜|移动距离统计|统计行走、飞行、游泳、鞘翅飞行等总距离（单位：米）|
|13|⚔️ 击杀榜|生物击杀统计|展示所有玩家击杀生物的总数排名|
|14|🤺 PVP 榜|玩家击杀统计|展示所有玩家击杀其他玩家的总数排名（PVP数据）|
|15|🛡️ 承伤榜|承受伤害统计|展示所有玩家受到的伤害总量排名|
|16|🗡️ 输出榜|造成伤害统计|展示所有玩家造成的伤害总量排名|
|17|☠️ 死亡榜|死亡次数统计|展示所有玩家的死亡次数排名|
|18|📈 全服总览|全服数据汇总|汇总显示所有榜单的全服总计数据，便于服务器管理|
|99|♻️ 清空数据|数据重置操作|**警告**：永久删除所有统计数据，操作不可恢复！|

## 🗑️ 卸载方法

为避免残留计分板影响服务器运行，卸载数据包需按以下步骤操作：

1. 以 OP 身份在游戏内输入卸载指令：
        `/function stats:admin/uninstall`

2. 等待聊天栏出现“卸载完成”提示


3. 找到服务器目录下的 `datapacks` 文件夹，删除本数据包对应的文件

注意事项：若未执行卸载指令直接删除数据包，会导致残留的计分板数据无法清理，可能影响其他数据包运行。
